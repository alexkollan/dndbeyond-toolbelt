var DNDBeyondToolbelt;(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var r={},l=[],i=0;i<e.length;i++){var s=e[i],c=a.base?s[0]+a.base:s[0],u=r[c]||0,d="".concat(c," ").concat(u);r[c]=u+1;var p=n(d),f={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)t[p].references++,t[p].updater(f);else{var m=o(f,a);a.byIndex=i,t.splice(i,0,{identifier:d,updater:m,references:1})}l.push(d)}return l}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var r=a(e=e||[],o=o||{});return function(e){e=e||[];for(var l=0;l<r.length;l++){var i=n(r[l]);t[i].references--}for(var s=a(e,o),c=0;c<r.length;c++){var u=n(r[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}r=s}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,a,o,r){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(a)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(l[s]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);a&&l[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=r),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},365:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(601),o=n.n(a),r=n(314),l=n.n(r)()(o());l.push([e.id,"/* D&D Beyond Toolbelt Styles */\n\n/* Toolbelt Button Integration */\n.ct-character-header-desktop__group--toolbelt {\n  margin-right: 12px;\n}\n\n.toolbelt-button {\n  display: flex;\n  align-items: center;\n  transition: all 0.2s ease;\n  cursor: pointer;\n}\n\n.toolbelt-button:hover {\n  opacity: 0.8;\n}\n\n.toolbelt-button:active {\n  transform: translateY(1px);\n}\n\n/* Fix SVG alignment and sizing */\n.toolbelt-button .ct-character-header-desktop__button-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  margin-right: 8px;\n}\n\n.toolbelt-button .ct-character-header-desktop__button-icon svg {\n  width: 16px;\n  height: 16px;\n  display: block;\n}\n\n/* Ensure the button matches D&D Beyond's styling exactly */\n.toolbelt-button .ct-character-header-desktop__button-label {\n  color: inherit;\n  font-size: inherit;\n  font-weight: inherit;\n  font-family: inherit;\n  line-height: 1;\n}\n\n/* Control Panel Styles */\n.toolbelt-control-panel {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 10000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.control-panel-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  backdrop-filter: blur(2px);\n}\n\n.control-panel-content {\n  position: relative;\n  background: #1e1e1e;\n  border: 2px solid #53a5c5;\n  border-radius: 12px;\n  min-width: 400px;\n  max-width: 500px;\n  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);\n  color: #ffffff;\n  font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n}\n\n.control-panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px;\n  border-bottom: 1px solid #333;\n}\n\n.control-panel-header h3 {\n  margin: 0;\n  color: #53a5c5;\n  font-size: 1.25rem;\n  font-weight: 600;\n}\n\n.control-panel-close {\n  background: none;\n  border: none;\n  color: #ffffff;\n  font-size: 24px;\n  cursor: pointer;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 6px;\n  transition: background-color 0.2s ease;\n}\n\n.control-panel-close:hover {\n  background-color: #333;\n}\n\n.control-panel-body {\n  padding: 20px 24px;\n}\n\n.control-panel-description {\n  margin: 0 0 20px 0;\n  color: #cccccc;\n  font-size: 0.9rem;\n  line-height: 1.4;\n}\n\n.features-list {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.feature-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: #2a2a2a;\n  border-radius: 8px;\n  border: 1px solid #333;\n  transition: border-color 0.2s ease;\n}\n\n.feature-item:hover {\n  border-color: #53a5c5;\n}\n\n.feature-toggle {\n  display: flex;\n  align-items: flex-start;\n  cursor: pointer;\n  flex: 1;\n}\n\n.feature-toggle input[type=\"checkbox\"] {\n  display: none;\n}\n\n.toggle-slider {\n  position: relative;\n  width: 44px;\n  height: 24px;\n  background: #444;\n  border-radius: 12px;\n  margin-right: 12px;\n  margin-top: 2px;\n  flex-shrink: 0;\n  transition: background-color 0.3s ease;\n}\n\n.toggle-slider::before {\n  content: '';\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  background: #ffffff;\n  border-radius: 50%;\n  top: 2px;\n  left: 2px;\n  transition: transform 0.3s ease;\n}\n\n.feature-toggle input[type=\"checkbox\"]:checked + .toggle-slider {\n  background: #53a5c5;\n}\n\n.feature-toggle input[type=\"checkbox\"]:checked + .toggle-slider::before {\n  transform: translateX(20px);\n}\n\n.feature-info {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n}\n\n.feature-label {\n  color: #ffffff;\n  font-size: 0.95rem;\n  font-weight: 500;\n  margin-bottom: 2px;\n}\n\n.feature-description {\n  color: #cccccc;\n  font-size: 0.8rem;\n  line-height: 1.3;\n}\n\n.feature-status {\n  margin-left: 12px;\n}\n\n.status-indicator {\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.status-indicator.enabled {\n  background: rgba(76, 175, 80, 0.2);\n  color: #4caf50;\n  border: 1px solid #4caf50;\n}\n\n.status-indicator.disabled {\n  background: rgba(244, 67, 54, 0.2);\n  color: #f44336;\n  border: 1px solid #f44336;\n}\n\n.control-panel-footer {\n  padding: 16px 24px;\n  border-top: 1px solid #333;\n  text-align: center;\n}\n\n.control-panel-footer small {\n  color: #888;\n  font-size: 0.8rem;\n}\n\n/* Responsive Design */\n@media (max-width: 480px) {\n  .control-panel-content {\n    min-width: 320px;\n    margin: 20px;\n  }\n  \n  .control-panel-header,\n  .control-panel-body,\n  .control-panel-footer {\n    padding-left: 16px;\n    padding-right: 16px;\n  }\n}\n",""]);const i=l},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,o&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={id:a,exports:{}};return e[a](r,r.exports,n),r.exports}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}function r(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;const l=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onClick=t,this.element=null},t=[{key:"render",value:function(){var e=this;return this.element||(this.element=document.createElement("div"),this.element.className="ct-character-header-desktop__button toolbelt-button",this.element.setAttribute("role","button"),this.element.setAttribute("tabindex","0"),this.element.innerHTML='\n      <div class="ct-character-header-desktop__button-icon">\n        <svg \n          xmlns="http://www.w3.org/2000/svg" \n          viewBox="0 0 50 50" \n          class="ddbc-svg ddbc-toolbelt-svg ddbc-svg--themed"\n        >\n          <path \n            fill="#53a5c5" \n            d="M25 5c-11 0-20 9-20 20s9 20 20 20 20-9 20-20S36 5 25 5zm0 36c-8.8 0-16-7.2-16-16S16.2 9 25 9s16 7.2 16 16-7.2 16-16 16z"\n          />\n          <path \n            fill="#53a5c5" \n            d="M32 18h-5v-5c0-1.1-.9-2-2-2s-2 .9-2 2v5h-5c-1.1 0-2 .9-2 2s.9 2 2 2h5v5c0 1.1.9 2 2 2s2-.9 2-2v-5h5c1.1 0 2-.9 2-2s-.9-2-2-2z"\n          />\n        </svg>\n      </div>\n      <span class="ct-character-header-desktop__button-label">Toolbelt</span>\n    ',this.element.addEventListener("click",this.onClick),this.element.addEventListener("keydown",function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.onClick())})),this.element}}],t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,u(a.key),a)}}function u(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}const d=function(){return e=function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.features=t,this.onToggleFeature=n,this.onClose=a,this.element=null},t=[{key:"render",value:function(){return this.element||(this.element=document.createElement("div"),this.element.className="toolbelt-control-panel",this.element.innerHTML='\n      <div class="control-panel-overlay"></div>\n      <div class="control-panel-content">\n        <div class="control-panel-header">\n          <h3>D&D Beyond Toolbelt</h3>\n          <button class="control-panel-close">√ó</button>\n        </div>\n        <div class="control-panel-body">\n          <p class="control-panel-description">\n            Toggle features to enhance your D&D Beyond experience\n          </p>\n          <div class="features-list">\n            '.concat(this.renderFeatures(),'\n          </div>\n        </div>\n        <div class="control-panel-footer">\n          <small>Version 1.0.0 - D&D Beyond Toolbelt</small>\n        </div>\n      </div>\n    '),this.attachEventListeners()),this.element}},{key:"renderFeatures",value:function(){return Object.entries(this.features).map(function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,o,r,l,i=[],s=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=r.call(n)).done)&&(i.push(a.value),i.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),n=t[0],a=t[1];return'\n      <div class="feature-item">\n        <label class="feature-toggle">\n          <input\n            type="checkbox"\n            data-feature="'.concat(n,'"\n            ').concat(a.enabled?"checked":"",'\n          />\n          <span class="toggle-slider"></span>\n          <span class="feature-info">\n            <span class="feature-label">').concat(a.label,'</span>\n            <span class="feature-description">').concat(a.description,'</span>\n          </span>\n        </label>\n        <div class="feature-status">\n          <span class="status-indicator ').concat(a.enabled?"enabled":"disabled",'">\n            ').concat(a.enabled?"ON":"OFF","\n          </span>\n        </div>\n      </div>\n    ")}).join("")}},{key:"attachEventListeners",value:function(){var e=this;this.element.querySelector(".control-panel-close").addEventListener("click",this.onClose),this.element.querySelector(".control-panel-overlay").addEventListener("click",this.onClose),this.element.querySelectorAll('input[type="checkbox"]').forEach(function(t){t.addEventListener("change",function(t){var n=t.target.dataset.feature;e.onToggleFeature(n)})});var t=function(n){"Escape"===n.key&&(e.onClose(),document.removeEventListener("keydown",t))};document.addEventListener("keydown",t)}},{key:"updateFeatures",value:function(e){var t=this;this.features=e,this.element.querySelector(".features-list").innerHTML=this.renderFeatures(),this.element.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.addEventListener("change",function(e){var n=e.target.dataset.feature;t.onToggleFeature(n)})})}}],t&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function f(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,m(a.key),a)}}function m(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}const b=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Spell Enhancements",this.description="Hide upcasted spells and show only base level versions",this.initialized=!1,this.hideUpcastedSpells=!1,this.hiddenSpells=new Set},(t=[{key:"init",value:function(){this.initialized||(console.log("üîÆ Spell Enhancements feature initialized"),this.initialized=!0)}},{key:"addToggleButton",value:function(){var e=this,t=document.querySelector(".ct-spells-filter");if(t){var n=document.createElement("button");n.className="ct-theme-button ct-theme-button--outline ct-theme-button--interactive ct-button character-button ddbc-button character-button-medium spell-enhancement-toggle",n.innerHTML='\n      <span class="ct-button__content">\n        <span class="spell-enhancement-icon">üîÆ</span>\n        Hide Upcasted Spells\n      </span>\n    ',n.style.marginLeft="10px",n.style.opacity=this.hideUpcastedSpells?"1":"0.7",n.addEventListener("click",function(){e.toggleUpcastedSpells()});var a=t.querySelector(".ct-spells-filter__callout button");a&&a.parentNode&&a.parentNode.appendChild(n)}}},{key:"toggleUpcastedSpells",value:function(){this.hideUpcastedSpells=!this.hideUpcastedSpells;var e=document.querySelector(".spell-enhancement-toggle");if(e){e.style.opacity=this.hideUpcastedSpells?"1":"0.7";var t=e.querySelector(".ct-button__content");t&&(t.innerHTML='\n          <span class="spell-enhancement-icon">üîÆ</span>\n          '.concat(this.hideUpcastedSpells?"Show All Spells":"Hide Upcasted Spells","\n        "))}this.hideUpcastedSpells?this.hideUpcastedSpellsFromDOM():this.showAllSpells(),console.log("üîÆ Upcasted spells ".concat(this.hideUpcastedSpells?"hidden":"shown"))}},{key:"hideUpcastedSpellsFromDOM",value:function(){var e=this;this.showAllSpells(),this.hiddenSpells.clear(),document.querySelectorAll(".ct-spells-spell").forEach(function(t){t.querySelector(".ct-spells-spell__scaled")&&(t.style.display="none",e.hiddenSpells.add(t),e.checkAndHideEmptySpellLevel(t))}),console.log("üîÆ Hidden ".concat(this.hiddenSpells.size," upcasted spells"))}},{key:"checkAndHideEmptySpellLevel",value:function(e){var t=e.closest(".ct-spells-level__spells-content");if(t){var n=t.querySelectorAll(".ct-spells-spell");if(0===Array.from(n).filter(function(e){return"none"!==e.style.display}).length){var a=t.closest(".ct-content-group");a&&(a.style.display="none",this.hiddenSpells.add(a))}}}},{key:"showAllSpells",value:function(){this.hiddenSpells.forEach(function(e){e.style.display=""}),this.hiddenSpells.clear()}},{key:"onTabChange",value:function(e,t){"Spells"===e&&t&&(console.log("üîÆ Spell Enhancements: Spells tab is now active!"),this.handleSpellsTab())}},{key:"handleSpellsTab",value:function(){var e=this;setTimeout(function(){document.querySelector(".spell-enhancement-toggle")||e.addToggleButton(),e.hideUpcastedSpells&&e.hideUpcastedSpellsFromDOM()},500)}}])&&f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),h={cantrip:[],"1st":[{name:"Find Familiar",url:"https://www.dndbeyond.com/spells/find-familiar",casting_time:"1 hour",range:"10 feet",attack:"--",damage:"Utility",components:{verbal:!0,somatic:!0,material:!0,duration:"Instantaneous"},source:"Player's Handbook"}],"2nd":[{name:"Web",url:"https://www.dndbeyond.com/spells/web",casting_time:"1 action",range:"60 feet",attack:"dex save",damage:"Control",components:{verbal:!0,somatic:!0,material:!0,duration:"Concentration, up to 1 hour"},source:"Player's Handbook"}],"3rd":[{name:"Counterspell",url:"https://www.dndbeyond.com/spells/counterspell",casting_time:"1 reaction",range:"60 feet",attack:"--",damage:"Control",components:{verbal:!1,somatic:!0,material:!1,duration:"Instantaneous"},source:"Player's Handbook"},{name:"Leomund's Tiny Hut",url:"https://www.dndbeyond.com/spells/leomunds-tiny-hut",casting_time:"1 minute",range:"10 feet",attack:"--",damage:"Utility",components:{verbal:!0,somatic:!0,material:!0,duration:"8 hours"},source:"Player's Handbook"}],"4th":[{name:"Banishment",url:"https://www.dndbeyond.com/spells/banishment",casting_time:"1 action",range:"60 feet",attack:"cha save",damage:"Banishment",components:{verbal:!0,somatic:!0,material:!0,duration:"Concentration, up to 1 minute"},source:"Player's Handbook"},{name:"Dimension Door",url:"https://www.dndbeyond.com/spells/dimension-door",casting_time:"1 action",range:"500 feet",attack:"--",damage:"Teleportation",components:{verbal:!0,somatic:!1,material:!1,duration:"Instantaneous"},source:"Player's Handbook"}],"5th":[{name:"Wall of Force",url:"https://www.dndbeyond.com/spells/wall-of-force",casting_time:"1 action",range:"120 feet",attack:"--",damage:"Control",components:{verbal:!0,somatic:!0,material:!0,duration:"Concentration, up to 10 minutes"},source:"Player's Handbook"},{name:"Mass Cure Wounds",url:"https://www.dndbeyond.com/spells/mass-cure-wounds",casting_time:"1 action",range:"60 feet",attack:"--",damage:"Healing",components:{verbal:!0,somatic:!0,material:!1,duration:"Instantaneous"},source:"Player's Handbook"},{name:"Animate Objects",url:"https://www.dndbeyond.com/spells/animate-objects",casting_time:"1 action",range:"120 feet",attack:"--",damage:"Control",components:{verbal:!0,somatic:!0,material:!1,duration:"Concentration, up to 1 minute"},source:"Player's Handbook"},{name:"Bigby's Hand",url:"https://www.dndbeyond.com/spells/bigbys-hand",casting_time:"1 action",range:"120 feet",attack:"--",damage:"Control",components:{verbal:!0,somatic:!0,material:!0,duration:"Concentration, up to 1 minute"},source:"Player's Handbook"}],"6th":[{name:"Heal",url:"https://www.dndbeyond.com/spells/heal",casting_time:"1 action",range:"Touch",attack:"--",damage:"Healing",components:{verbal:!0,somatic:!0,material:!1,duration:"Instantaneous"},source:"Player's Handbook"},{name:"Disintegrate",url:"https://www.dndbeyond.com/spells/disintegrate",casting_time:"1 action",range:"60 feet",attack:"dex save",damage:"10d6+40 force",components:{verbal:!0,somatic:!0,material:!0,duration:"Instantaneous"},source:"Player's Handbook"},{name:"Otto's Irresistible Dance",url:"https://www.dndbeyond.com/spells/ottos-irresistible-dance",casting_time:"1 action",range:"30 feet",attack:"wis save",damage:"Control",components:{verbal:!0,somatic:!1,material:!1,duration:"Concentration, up to 1 minute"},source:"Player's Handbook"}],"7th":[{name:"Plane Shift",url:"https://www.dndbeyond.com/spells/plane-shift",casting_time:"1 action",range:"Touch",attack:"cha save",damage:"Banishment",components:{verbal:!0,somatic:!0,material:!0,duration:"Instantaneous"},source:"Player's Handbook"},{name:"Mordenkainen's Magnificent Mansion",url:"https://www.dndbeyond.com/spells/mordenkainens-magnificent-mansion",casting_time:"1 minute",range:"300 feet",attack:"--",damage:"Utility",components:{verbal:!0,somatic:!0,material:!0,duration:"24 hours"},source:"Player's Handbook"},{name:"Simulacrum",url:"https://www.dndbeyond.com/spells/simulacrum",casting_time:"12 hours",range:"Touch",attack:"--",damage:"Creation",components:{verbal:!0,somatic:!0,material:!0,duration:"Until dispelled"},source:"Player's Handbook"},{name:"Forcecage",url:"https://www.dndbeyond.com/spells/forcecage",casting_time:"1 action",range:"100 feet",attack:"cha save",damage:"Control",components:{verbal:!0,somatic:!0,material:!0,duration:"1 hour"},source:"Player's Handbook"},{name:"Mirage Arcane",url:"https://www.dndbeyond.com/spells/mirage-arcane",casting_time:"10 minutes",range:"Sight",attack:"--",damage:"Illusion",components:{verbal:!0,somatic:!0,material:!1,duration:"10 days"},source:"Player's Handbook"}],"8th":[{name:"Clone",url:"https://www.dndbeyond.com/spells/clone",casting_time:"1 hour",range:"Touch",attack:"--",damage:"Creation",components:{verbal:!0,somatic:!0,material:!0,duration:"Instantaneous"},source:"Player's Handbook"},{name:"Maze",url:"https://www.dndbeyond.com/spells/maze",casting_time:"1 action",range:"60 feet",attack:"--",damage:"Banishment",components:{verbal:!0,somatic:!0,material:!1,duration:"Concentration, up to 10 minutes"},source:"Player's Handbook"},{name:"Control Weather",url:"https://www.dndbeyond.com/spells/control-weather",casting_time:"10 minutes",range:"Self (5-mile radius)",attack:"--",damage:"Control",components:{verbal:!0,somatic:!0,material:!0,duration:"Concentration, up to 8 hours"},source:"Player's Handbook"},{name:"Glibness",url:"https://www.dndbeyond.com/spells/glibness",casting_time:"1 action",range:"Self",attack:"--",damage:"Enhancement",components:{verbal:!0,somatic:!1,material:!1,duration:"1 hour"},source:"Player's Handbook"},{name:"Feeblemind",url:"https://www.dndbeyond.com/spells/feeblemind",casting_time:"1 action",range:"150 feet",attack:"int save",damage:"Debuff",components:{verbal:!0,somatic:!0,material:!0,duration:"Instantaneous"},source:"Player's Handbook"},{name:"Mind Blank",url:"https://www.dndbeyond.com/spells/mind-blank",casting_time:"1 action",range:"Touch",attack:"--",damage:"Protection",components:{verbal:!0,somatic:!0,material:!1,duration:"24 hours"},source:"Player's Handbook"}],"9th":[]};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,o,r,l,i=[],s=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=r.call(n)).done)&&(i.push(a.value),i.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return i}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function k(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,S(a.key),a)}}function S(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}const _=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Add Extra Spells",this.description="Adds custom spells to the spells tab with dark purple cast buttons",this.initialized=!1,this.extraSpells=h,this.addedSpells=new Set},t=[{key:"init",value:function(){var e=this;this.initialized||(this.loadExtraSpells(),window.dndbToolbelt=window.dndbToolbelt||{},window.dndbToolbelt.addExtraSpells=function(){e.handleSpellsTab()},this.initialized=!0)}},{key:"disable",value:function(){this.removeExtraSpells(),this.addedSpells.clear()}},{key:"loadExtraSpells",value:function(){}},{key:"onTabChange",value:function(e,t){"Spells"===e&&t&&this.handleSpellsTab()}},{key:"handleSpellsTab",value:function(){var e=this;setTimeout(function(){e.addCustomStyles(),e.addExtraSpellsToDOM()},500)}},{key:"addExtraSpellsToDOM",value:function(){var e=this;this.extraSpells&&0!==Object.keys(this.extraSpells).length&&(this.addedSpells.clear(),Object.entries(this.extraSpells).forEach(function(t){var n=g(t,2),a=n[0],o=n[1];e.addSpellsToLevel(a,o)}))}},{key:"addSpellsToLevel",value:function(e,t){var n=this,a=this.findSpellLevelContainer(e);if(a){var o=a.querySelector(".ct-spells-level__spells-content");o&&t.forEach(function(t){var a="".concat(e,"-").concat(t.name.replace(/\s+/g,"-").toLowerCase());if(o.querySelector('[data-spell-id="'.concat(a,'"]')))n.addedSpells.add(a);else{var r=n.createSpellElement(t,a);o.appendChild(r),n.addedSpells.add(a)}})}}},{key:"findSpellLevelContainer",value:function(e){var t={cantrip:"Cantrip","1st":"1st Level","2nd":"2nd Level","3rd":"3rd Level","4th":"4th Level","5th":"5th Level","6th":"6th Level","7th":"7th Level","8th":"8th Level","9th":"9th Level"}[e];if(!t)return null;var n,a=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=v(e))){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return r=e.done,e},e:function(e){l=!0,o=e},f:function(){try{r||null==t.return||t.return()}finally{if(l)throw o}}}}(document.querySelectorAll(".ct-content-group__header-content"));try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.textContent.trim()===t){var r=o.closest(".ct-content-group");if(r)return r}}}catch(e){a.e(e)}finally{a.f()}return null}},{key:"createSpellElement",value:function(e,t){var n=document.createElement("div");return n.className="ct-spells-spell",n.setAttribute("data-spell-id",t),n.innerHTML='\n      <div class="ct-spells-spell__action">\n        <button class="ct-theme-button ct-theme-button--filled ct-theme-button--interactive ct-button character-button ddbc-button character-button-block-small dndb-toolbelt-extra-spell" role="button">\n          <span class="ct-button__content">Cast</span>\n        </button>\n      </div>\n      <div class="ct-spells-spell__name">\n        <div class="ct-spells-spell__label">\n          '.concat(e.url?'<a href="'.concat(e.url,'" target="_blank" rel="noopener noreferrer" class="styles_spellName__wX3ll" style="text-decoration: none; color: inherit;">').concat(e.name,"</a>"):'<span class="styles_spellName__wX3ll">'.concat(e.name,"</span>"),'\n        </div>\n        <div class="ct-spells-spell__meta ct-spells-spell__meta--dark-mode">\n          <span class="ct-spells-spell__meta-item">Custom</span>\n          <span class="ct-spells-spell__meta-item">').concat(e.source||"Homebrew",'</span>\n        </div>\n      </div>\n      <div class="ct-spells-spell__activation ct-spells-spell__activation--dark-mode">\n        <span class="ddbc-tooltip ddbc-tooltip--dark-mode" data-tippy="" data-original-title="').concat(e.casting_time,'">').concat(this.formatCastingTime(e.casting_time),'</span>\n      </div>\n      <div class="ct-spells-spell__range ct-spells-spell--dark-mode">\n        <span class="ct-spells-spell__range-value">').concat(this.formatRange(e.range),'</span>\n      </div>\n      <div class="ct-spells-spell__attacking">\n        ').concat(this.formatAttack(e.attack),'\n      </div>\n      <div class="ct-spells-spell__damage">\n        ').concat(this.formatDamage(e.damage),'\n      </div>\n      <div class="ct-spells-spell__notes">\n        ').concat(this.formatComponents(e.components),"\n      </div>\n    "),n}},{key:"formatCastingTime",value:function(e){return{"1 action":"1A","1 bonus action":"1BA","1 reaction":"1R","1 minute":"1m","10 minutes":"10m","1 hour":"1h","8 hours":"8h","24 hours":"24h"}[e]||e}},{key:"formatRange",value:function(e){if("Self"===e||"Touch"===e)return'<span class="ct-spells-spell__range-origin">'.concat(e,"</span>");var t=e.match(/(\d+)\s*(feet|ft)/i);return t?'<span class="styles_numberDisplay__Rg1za"><span>'.concat(t[1],'</span><span class="styles_label__L8mZK styles_labelSignColor__Klmbs">ft.</span></span>'):'<span class="ct-spells-spell__range-value">'.concat(e,"</span>")}},{key:"formatAttack",value:function(e){if(!e||"--"===e)return'<div class="ct-spells-spell__empty-value">--</div>';if(e.includes("save")){var t=e.match(/(\w+)\s+(\d+)/i);if(t){var n=g(t,3),a=n[1],o=n[2];return'\n          <div class="ct-spells-spell__save">\n            <span class="ct-spells-spell__save-label ct-spells-spell--dark-mode">'.concat(a.toLowerCase(),'</span>\n            <span class="ct-spells-spell__save-value ct-spells-spell--dark-mode">').concat(o,"</span>\n          </div>\n        ")}}if(e.includes("+")){var r=e.replace("+","");return'\n        <div class="ct-spells-spell__tohit">\n          <button aria-haspopup="menu" class="integrated-dice__container">\n            <span class="styles_numberDisplay__Rg1za styles_signed__scf97">\n              <span class="styles_sign__NdR6X styles_labelSignColor__Klmbs" aria-label="plus">+</span>\n              <span>'.concat(r,"</span>\n            </span>\n          </button>\n        </div>\n      ")}return'<div class="ct-spells-spell__empty-value">--</div>'}},{key:"formatDamage",value:function(e){if(!e||"--"===e)return'\n        <div class="ddbc-spell-damage-effect ddbc-spell-damage-effect--dark-mode">\n          <span class="ddbc-spell-damage-effect__tags ddbc-spell-damage-effect__tags--dark-mode">Varies</span>\n        </div>\n      ';var t=e.match(/(\d+d\d+(?:\+\d+)?)\s*(\w+)?/i);if(t){var n=g(t,3),a=n[1],o=n[2],r=this.getDamageTypeIcon(o);return'\n        <div class="ddbc-spell-damage-effect ddbc-spell-damage-effect--dark-mode">\n          <span class="ddbc-spell-damage-effect__damages">\n            <button aria-haspopup="menu" class="integrated-dice__container">\n              <span class="ddbc-damage__value ddbc-damage__value--dark-mode">'.concat(a,"</span>\n              ").concat(r,"\n            </button>\n          </span>\n        </div>\n      ")}return'\n      <div class="ddbc-spell-damage-effect ddbc-spell-damage-effect--dark-mode">\n        <span class="ddbc-spell-damage-effect__tags ddbc-spell-damage-effect__tags--dark-mode">'.concat(e,"</span>\n      </div>\n    ")}},{key:"getDamageTypeIcon",value:function(e){if(!e)return"";var t={fire:"fire",cold:"cold",lightning:"lightning",thunder:"thunder",acid:"acid",poison:"poison",necrotic:"necrotic",radiant:"radiant",psychic:"psychic",force:"force",piercing:"piercing",slashing:"slashing",bludgeoning:"bludgeoning"}[e.toLowerCase()];return t?'\n        <span class="ddbc-damage__icon">\n          <span class="ddbc-damage-type-icon ddbc-damage-type-icon--'.concat(t,'" aria-label="').concat(e,' damage">\n            <span class="ddbc-tooltip ddbc-tooltip--dark-mode" data-tippy="" data-original-title="').concat(e,'">\n              \x3c!-- SVG icon would go here --\x3e\n            </span>\n          </span>\n        </span>\n      '):""}},{key:"formatComponents",value:function(e){var t=this;if(!e)return'<div class="ddbc-note-components"></div>';var n=[];if(e.duration){var a={Instantaneous:"Instant","1 minute":"D: 1m","10 minutes":"D: 10m","1 hour":"D: 1h","8 hours":"D: 8h","24 hours":"D: 24h","Until dispelled":"D: Until dispelled","Concentration, up to 1 minute":"D: 1m","Concentration, up to 10 minutes":"D: 10m","Concentration, up to 1 hour":"D: 1h"}[e.duration]||e.duration;n.push('<span class="ddbc-tooltip ddbc-note-components__component ddbc-note-components__component--tooltip ddbc-note-components__component--dark-mode ddbc-tooltip--dark-mode" data-tippy="" data-original-title="'.concat(e.duration,'">').concat(a,"</span>"))}var o=[];if(e.verbal&&o.push("V"),e.somatic&&o.push("S"),e.material&&o.push("M"),o.length>0){var r=o.map(function(e){return'<span class="ddbc-tooltip ddbc-note-components__component ddbc-note-components__component--tooltip ddbc-note-components__component--dark-mode ddbc-tooltip--dark-mode" data-tippy="" data-original-title="'.concat(t.getComponentTooltip(e),'">').concat(e,"</span>")}).join("/");n.push(r)}return'<div class="ddbc-note-components">'.concat(n.join(", "),"</div>")}},{key:"getComponentTooltip",value:function(e){return{V:"Verbal",S:"Somatic",M:"Material"}[e]||e}},{key:"addCustomStyles",value:function(){if(!document.getElementById("dndb-toolbelt-extra-spells-styles")){var e=document.createElement("style");e.id="dndb-toolbelt-extra-spells-styles",e.textContent="\n      .dndb-toolbelt-extra-spell {\n        background-color: #4a148c !important;\n        border-color: #4a148c !important;\n      }\n      \n      .dndb-toolbelt-extra-spell:hover {\n        background-color: #6a1b9a !important;\n        border-color: #6a1b9a !important;\n      }\n      \n      .dndb-toolbelt-extra-spell:active {\n        background-color: #38006b !important;\n        border-color: #38006b !important;\n      }\n\n      .dndb-toolbelt-extra-spell .ct-button__content {\n        color: white !important;\n      }\n\n      /* Styling for clickable spell names */\n      [data-spell-id] .styles_spellName__wX3ll a {\n        transition: color 0.2s ease;\n      }\n\n      [data-spell-id] .styles_spellName__wX3ll a:hover {\n        color: #4a148c !important;\n        text-decoration: underline !important;\n      }\n    ",document.head.appendChild(e)}}},{key:"removeExtraSpells",value:function(){document.querySelectorAll("[data-spell-id]").forEach(function(e){e.remove()})}}],t&&k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function T(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,P(a.key),a)}}function P(e){var t=function(e){if("object"!=x(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==x(t)?t:t+""}const F=function(){return e=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tabDetector=t,this.features={spellEnhancements:new b,addExtraSpells:new _},this.enabledFeatures=new Set,this.storageKey="dndbeyond-toolbelt-enabled-features",this.loadEnabledFeatures(),this.tabDetector&&this.tabDetector.addTabChangeListener(function(e,t){n.enabledFeatures.forEach(function(a){var o=n.features[a];o&&o.onTabChange&&o.onTabChange(e,t)})})},t=[{key:"enableFeature",value:function(e){var t=this.features[e];if(t&&!this.enabledFeatures.has(e))try{t.initialized||t.init(),this.enabledFeatures.add(e),this.saveEnabledFeatures()}catch(t){console.error("‚ùå Failed to enable feature ".concat(e,":"),t)}}},{key:"disableFeature",value:function(e){var t=this.features[e];if(t&&this.enabledFeatures.has(e))try{"function"==typeof t.disable&&t.disable(),this.enabledFeatures.delete(e),this.saveEnabledFeatures()}catch(t){console.error("‚ùå Failed to disable feature ".concat(e,":"),t)}}},{key:"isFeatureEnabled",value:function(e){return this.enabledFeatures.has(e)}},{key:"getAllEnabledFeatures",value:function(){return Array.from(this.enabledFeatures)}},{key:"getAllFeatures",value:function(){return Object.keys(this.features)}},{key:"getFeatureInfo",value:function(e){var t=this.features[e];return t?{name:t.name,description:t.description,enabled:this.isFeatureEnabled(e),initialized:t.initialized}:null}},{key:"getAllFeaturesInfo",value:function(){var e=this;return Object.keys(this.features).map(function(t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){T(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({key:t},e.getFeatureInfo(t))})}},{key:"disableAllFeatures",value:function(){var e=this;this.enabledFeatures.forEach(function(t){e.disableFeature(t)})}},{key:"saveEnabledFeatures",value:function(){if(!this.isLoading)try{var e=Array.from(this.enabledFeatures);localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(e){console.error("‚ùå Failed to save enabled features to local storage:",e)}}},{key:"loadEnabledFeatures",value:function(){var e=this;try{var t=localStorage.getItem(this.storageKey);if(t){var n=JSON.parse(t);this.enabledFeatures.clear(),n.length>0&&(this.isLoading=!0,n.forEach(function(t){e.features[t]&&e.enableFeature(t)}),this.isLoading=!1)}else this.enabledFeatures.clear(),this.saveEnabledFeatures()}catch(e){console.error("‚ùå Failed to load enabled features from local storage:",e),localStorage.removeItem(this.storageKey),this.enabledFeatures.clear()}}},{key:"clearStoredPreferences",value:function(){try{localStorage.removeItem(this.storageKey)}catch(e){console.error("‚ùå Failed to clear stored preferences:",e)}}}],t&&E(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,D(a.key),a)}}function D(e){var t=function(e){if("object"!=j(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:t+""}const A=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentTab=null,this.observers=[],this.tabChangeListeners=[],this.isWatching=!1},(t=[{key:"init",value:function(){this.isWatching||(console.log("üëÅÔ∏è Tab detector initialized"),this.startWatching(),this.isWatching=!0)}},{key:"startWatching",value:function(){var e=this;this.detectCurrentTab();var t=new MutationObserver(function(){e.detectCurrentTab()}),n=document.querySelector('menu[class*="styles_tabs_"]');n&&t.observe(n,{attributes:!0,subtree:!0,attributeFilter:["aria-checked"]});var a=new MutationObserver(function(){var n=document.querySelector('menu[class*="styles_tabs_"]');n&&!e.observers.includes(n)&&t.observe(n,{attributes:!0,subtree:!0,attributeFilter:["aria-checked"]})});a.observe(document.body,{childList:!0,subtree:!0}),this.observers.push(t,a)}},{key:"detectCurrentTab",value:function(){var e=this,t=document.querySelector('menu[class*="styles_tabs_"]');if(t){var n=t.querySelectorAll("li button"),a=null;n.forEach(function(t){var n="true"===t.getAttribute("aria-checked"),o=t.textContent.trim();n&&(a=o),(e.currentTab!==o||n)&&e.notifyTabChange(o,n)}),this.currentTab!==a&&(console.log("üîÑ Tab changed: ".concat(this.currentTab," ‚Üí ").concat(a)),this.currentTab=a)}else null!==this.currentTab&&(this.currentTab=null,this.notifyTabChange(null,!1))}},{key:"addTabChangeListener",value:function(e){this.tabChangeListeners.push(e)}},{key:"removeTabChangeListener",value:function(e){var t=this.tabChangeListeners.indexOf(e);t>-1&&this.tabChangeListeners.splice(t,1)}},{key:"notifyTabChange",value:function(e,t){this.tabChangeListeners.forEach(function(n){try{n(e,t)}catch(e){console.error("Error in tab change listener:",e)}})}},{key:"getCurrentTab",value:function(){return this.currentTab}},{key:"destroy",value:function(){this.observers.forEach(function(e){return e.disconnect()}),this.observers=[],this.tabChangeListeners=[],this.isWatching=!1,console.log("üëÅÔ∏è Tab detector destroyed")}}])&&O(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function M(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,H(a.key),a)}}function H(e){var t=function(e){if("object"!=L(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==L(t)?t:t+""}const I=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.isControlPanelOpen=!1,this.tabDetector=new A,this.featureManager=new F(this.tabDetector),this.globalToggleEnabled=!0,this.button=null,this.controlPanel=null,this.toggleControlPanel=this.toggleControlPanel.bind(this),this.toggleFeature=this.toggleFeature.bind(this),this.closeControlPanel=this.closeControlPanel.bind(this)},(t=[{key:"mount",value:function(){this.button=new l(this.toggleControlPanel);var e=this.button.render();this.container.appendChild(e),this.tabDetector.init()}},{key:"toggleControlPanel",value:function(){this.isControlPanelOpen=!this.isControlPanelOpen,this.isControlPanelOpen?this.showControlPanel():this.hideControlPanel()}},{key:"showControlPanel",value:function(){this.controlPanel||(this.controlPanel=new d(this.getFeaturesForUI(),this.toggleFeature,this.closeControlPanel)),document.body.appendChild(this.controlPanel.render())}},{key:"hideControlPanel",value:function(){this.controlPanel&&this.controlPanel.element&&document.body.removeChild(this.controlPanel.element)}},{key:"closeControlPanel",value:function(){this.isControlPanelOpen=!1,this.hideControlPanel()}},{key:"getFeaturesForUI",value:function(){var e=this.featureManager.getAllFeaturesInfo(),t={};return e.forEach(function(e){t[e.key]={label:e.name,description:e.description,enabled:e.enabled}}),t.globalToggle={label:"Enable All Features",description:"Master toggle for all toolbelt features",enabled:this.globalToggleEnabled},t}},{key:"toggleFeature",value:function(e){var t=this;if("globalToggle"===e)this.globalToggleEnabled=!this.globalToggleEnabled,this.featureManager.getAllFeatures().forEach(function(e){t.globalToggleEnabled?t.featureManager.enableFeature(e):t.featureManager.disableFeature(e)});else{this.featureManager.isFeatureEnabled(e)?this.featureManager.disableFeature(e):this.featureManager.enableFeature(e);var n=this.featureManager.getAllFeatures().every(function(e){return t.featureManager.isFeatureEnabled(e)});this.globalToggleEnabled=n}this.controlPanel&&this.controlPanel.updateFeatures(this.getFeaturesForUI())}}])&&M(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();var z=n(72),U=n.n(z),B=n(825),q=n.n(B),N=n(659),R=n.n(N),W=n(56),K=n.n(W),V=n(540),X=n.n(V),G=n(113),J=n.n(G),$=n(365),Y={};function Z(){var e=document.querySelector(".ct-character-header-desktop");if(!e)return console.log("D&D Beyond character header not found, retrying...!"),void setTimeout(Z,1e3);console.log("D&D Beyond Toolbelt initializing.");var t=e.querySelector(".ct-character-header-desktop__group--share");if(!t)return console.log("Share button group not found, retrying..."),void setTimeout(Z,1e3);if(document.getElementById("dndbeyond-toolbelt-root"))console.log("D&D Beyond Toolbelt already initialized...!");else{var n=document.createElement("div");n.id="dndbeyond-toolbelt-root",n.className="ct-character-header-desktop__group ct-character-header-desktop__group--toolbelt",t.parentNode.insertBefore(n,t),new I(n).mount(),console.log("D&D Beyond Toolbelt initialized successfully!")}}Y.styleTagTransform=J(),Y.setAttributes=K(),Y.insert=R().bind(null,"head"),Y.domAPI=q(),Y.insertStyleElement=X(),U()($.A,Y),$.A&&$.A.locals&&$.A.locals,(window.location.hostname.includes("dndbeyond.com")||window.location.hostname.includes("localhost"))&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",Z):Z()),window.DNDBeyondToolbelt={init:Z},DNDBeyondToolbelt={}})();